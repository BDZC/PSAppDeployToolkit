"use strict";(self.webpackChunkpsadt_docs=self.webpackChunkpsadt_docs||[]).push([[4165],{2140:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>o});var a=l(3274),i=l(3309);const t={id:"Execute-MSI",title:"Execute-MSI",description:'Help page for the "Execute-MSI" command',keywords:["PSAppDeployToolkit","PowerShell","Help","Documentation"],hide_title:!1,hide_table_of_contents:!1},s=void 0,r={id:"reference/functions/Execute-MSI",title:"Execute-MSI",description:'Help page for the "Execute-MSI" command',source:"@site/docs/reference/functions/Execute-MSI.mdx",sourceDirName:"reference/functions",slug:"/reference/functions/Execute-MSI",permalink:"/docs/reference/functions/Execute-MSI",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"Execute-MSI",title:"Execute-MSI",description:'Help page for the "Execute-MSI" command',keywords:["PSAppDeployToolkit","PowerShell","Help","Documentation"],hide_title:!1,hide_table_of_contents:!1},sidebar:"reference",previous:{title:"Enable-TerminalServerInstallMode",permalink:"/docs/reference/functions/Enable-TerminalServerInstallMode"},next:{title:"Execute-MSP",permalink:"/docs/reference/functions/Execute-MSP"}},c={},o=[{value:"SYNOPSIS",id:"synopsis",level:2},{value:"SYNTAX",id:"syntax",level:2},{value:"DESCRIPTION",id:"description",level:2},{value:"EXAMPLES",id:"examples",level:2},{value:"EXAMPLE 1",id:"example-1",level:3},{value:"EXAMPLE 2",id:"example-2",level:3},{value:"EXAMPLE 3",id:"example-3",level:3},{value:"EXAMPLE 4",id:"example-4",level:3},{value:"EXAMPLE 5",id:"example-5",level:3},{value:"PARAMETERS",id:"parameters",level:2},{value:"-Action",id:"-action",level:3},{value:"-Path",id:"-path",level:3},{value:"-Transform",id:"-transform",level:3},{value:"-Parameters",id:"-parameters",level:3},{value:"-AddParameters",id:"-addparameters",level:3},{value:"-SecureParameters",id:"-secureparameters",level:3},{value:"-Patch",id:"-patch",level:3},{value:"-LoggingOptions",id:"-loggingoptions",level:3},{value:"-private",id:"-private",level:3},{value:"-WorkingDirectory",id:"-workingdirectory",level:3},{value:"-SkipMSIAlreadyInstalledCheck",id:"-skipmsialreadyinstalledcheck",level:3},{value:"-IncludeUpdatesAndHotfixes",id:"-includeupdatesandhotfixes",level:3},{value:"-NoWait",id:"-nowait",level:3},{value:"-PassThru",id:"-passthru",level:3},{value:"-IgnoreExitCodes",id:"-ignoreexitcodes",level:3},{value:"-PriorityClass",id:"-priorityclass",level:3},{value:"-ExitOnProcessFailure",id:"-exitonprocessfailure",level:3},{value:"-RepairFromSource",id:"-repairfromsource",level:3},{value:"-ContinueOnError",id:"-continueonerror",level:3},{value:"CommonParameters",id:"commonparameters",level:3},{value:"INPUTS",id:"inputs",level:2},{value:"None",id:"none",level:3},{value:"You cannot pipe objects to this function.",id:"you-cannot-pipe-objects-to-this-function",level:3},{value:"OUTPUTS",id:"outputs",level:2},{value:"PSObject",id:"psobject",level:3},{value:"Returns a PSObject with the results of the installation",id:"returns-a-psobject-with-the-results-of-the-installation",level:3},{value:"- ExitCode",id:"--exitcode",level:3},{value:"- STDOut",id:"--stdout",level:3},{value:"- STDErr",id:"--stderr",level:3},{value:"NOTES",id:"notes",level:2},{value:"RELATED LINKS",id:"related-links",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"synopsis",children:"SYNOPSIS"}),"\n",(0,a.jsx)(n.p,{children:"Executes msiexec.exe to perform the following actions for MSI & MSP files and MSI product codes: install, uninstall, patch, repair, active setup."}),"\n",(0,a.jsx)(n.h2,{id:"syntax",children:"SYNTAX"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Execute-MSI [[-Action] <String>] [-Path] <String> [[-Transform] <String>] [[-Parameters] <String>]\n [[-AddParameters] <String>] [-SecureParameters] [[-Patch] <String>] [[-LoggingOptions] <String>]\n [[-private:LogName] <String>] [[-WorkingDirectory] <String>] [-SkipMSIAlreadyInstalledCheck]\n [-IncludeUpdatesAndHotfixes] [-NoWait] [-PassThru] [[-IgnoreExitCodes] <String>]\n [[-PriorityClass] <ProcessPriorityClass>] [[-ExitOnProcessFailure] <Boolean>] [[-RepairFromSource] <Boolean>]\n [[-ContinueOnError] <Boolean>] [<CommonParameters>]\n"})}),"\n",(0,a.jsx)(n.h2,{id:"description",children:"DESCRIPTION"}),"\n",(0,a.jsx)(n.p,{children:"Executes msiexec.exe to perform the following actions for MSI & MSP files and MSI product codes: install, uninstall, patch, repair, active setup."}),"\n",(0,a.jsx)(n.p,{children:'If the -Action parameter is set to "Install" and the MSI is already installed, the function will exit.'}),"\n",(0,a.jsx)(n.p,{children:"Sets default switches to be passed to msiexec based on the preferences in the XML configuration file."}),"\n",(0,a.jsx)(n.p,{children:"Automatically generates a log file name and creates a verbose log file for all msiexec operations."}),"\n",(0,a.jsx)(n.p,{children:'Expects the MSI or MSP file to be located in the "Files" sub directory of the App Deploy Toolkit.\nExpects transform files to be in the same directory as the MSI file.'}),"\n",(0,a.jsx)(n.h2,{id:"examples",children:"EXAMPLES"}),"\n",(0,a.jsx)(n.h3,{id:"example-1",children:"EXAMPLE 1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Execute-MSI -Action 'Install' -Path 'Adobe_FlashPlayer_11.2.202.233_x64_EN.msi'\n"})}),"\n",(0,a.jsx)(n.p,{children:"Installs an MSI"}),"\n",(0,a.jsx)(n.h3,{id:"example-2",children:"EXAMPLE 2"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Execute-MSI -Action 'Install' -Path 'Adobe_FlashPlayer_11.2.202.233_x64_EN.msi' -Transform 'Adobe_FlashPlayer_11.2.202.233_x64_EN_01.mst' -Parameters '/QN'\n"})}),"\n",(0,a.jsx)(n.p,{children:"Installs an MSI, applying a transform and overriding the default MSI toolkit parameters"}),"\n",(0,a.jsx)(n.h3,{id:"example-3",children:"EXAMPLE 3"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"[PSObject]$ExecuteMSIResult = Execute-MSI -Action 'Install' -Path 'Adobe_FlashPlayer_11.2.202.233_x64_EN.msi' -PassThru\n"})}),"\n",(0,a.jsx)(n.p,{children:"Installs an MSI and stores the result of the execution into a variable by using the -PassThru option"}),"\n",(0,a.jsx)(n.h3,{id:"example-4",children:"EXAMPLE 4"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Execute-MSI -Action 'Uninstall' -Path '{26923b43-4d38-484f-9b9e-de460746276c}'\n"})}),"\n",(0,a.jsx)(n.p,{children:"Uninstalls an MSI using a product code"}),"\n",(0,a.jsx)(n.h3,{id:"example-5",children:"EXAMPLE 5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Execute-MSI -Action 'Patch' -Path 'Adobe_Reader_11.0.3_EN.msp'\n"})}),"\n",(0,a.jsx)(n.p,{children:"Installs an MSP"}),"\n",(0,a.jsx)(n.h2,{id:"parameters",children:"PARAMETERS"}),"\n",(0,a.jsx)(n.h3,{id:"-action",children:"-Action"}),"\n",(0,a.jsx)(n.p,{children:"The action to perform.\nOptions: Install, Uninstall, Patch, Repair, ActiveSetup."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: Install\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-path",children:"-Path"}),"\n",(0,a.jsx)(n.p,{children:"The path to the MSI/MSP file or the product code of the installed MSI."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases: FilePath\n\nRequired: True\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-transform",children:"-Transform"}),"\n",(0,a.jsx)(n.p,{children:"The name of the transform file(s) to be applied to the MSI.\nThe transform file is expected to be in the same directory as the MSI file.\nMultiple transforms have to be separated by a semi-colon."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 3\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-parameters",children:"-Parameters"}),"\n",(0,a.jsx)(n.p,{children:'Overrides the default parameters specified in the XML configuration file.\nInstall default is: "REBOOT=ReallySuppress /QB!".\nUninstall default is: "REBOOT=ReallySuppress /QN".'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases: Arguments\n\nRequired: False\nPosition: 4\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-addparameters",children:"-AddParameters"}),"\n",(0,a.jsx)(n.p,{children:'Adds to the default parameters specified in the XML configuration file.\nInstall default is: "REBOOT=ReallySuppress /QB!".\nUninstall default is: "REBOOT=ReallySuppress /QN".'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 5\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-secureparameters",children:"-SecureParameters"}),"\n",(0,a.jsx)(n.p,{children:"Hides all parameters passed to the MSI or MSP file from the toolkit Log file."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-patch",children:"-Patch"}),"\n",(0,a.jsx)(n.p,{children:'The name of the patch (msp) file(s) to be applied to the MSI for use with the "Install" action.\nThe patch file is expected to be in the same directory as the MSI file.\nMultiple patches have to be separated by a semi-colon.'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 6\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-loggingoptions",children:"-LoggingOptions"}),"\n",(0,a.jsx)(n.p,{children:'Overrides the default logging options specified in the XML configuration file.\nDefault options are: "/L*v".'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 7\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"-private",children:["-private",":LogName"]}),"\n",(0,a.jsxs)(n.p,{children:["{{ Fill private",":LogName"," Description }}"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases: LogName\n\nRequired: False\nPosition: 8\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-workingdirectory",children:"-WorkingDirectory"}),"\n",(0,a.jsx)(n.p,{children:"Overrides the working directory.\nThe working directory is set to the location of the MSI file."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 9\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-skipmsialreadyinstalledcheck",children:"-SkipMSIAlreadyInstalledCheck"}),"\n",(0,a.jsx)(n.p,{children:"Skips the check to determine if the MSI is already installed on the system.\nDefault is: $false."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-includeupdatesandhotfixes",children:"-IncludeUpdatesAndHotfixes"}),"\n",(0,a.jsx)(n.p,{children:"Include matches against updates and hotfixes in results."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-nowait",children:"-NoWait"}),"\n",(0,a.jsx)(n.p,{children:"Immediately continue after executing the process."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-passthru",children:"-PassThru"}),"\n",(0,a.jsx)(n.p,{children:"Returns ExitCode, STDOut, and STDErr output from the process."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-ignoreexitcodes",children:"-IgnoreExitCodes"}),"\n",(0,a.jsx)(n.p,{children:"List the exit codes to ignore or * to ignore all exit codes."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 10\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-priorityclass",children:"-PriorityClass"}),"\n",(0,a.jsx)(n.p,{children:"Specifies priority class for the process.\nOptions: Idle, Normal, High, AboveNormal, BelowNormal, RealTime.\nDefault: Normal"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: ProcessPriorityClass\nParameter Sets: (All)\nAliases:\nAccepted values: Normal, Idle, High, RealTime, BelowNormal, AboveNormal\n\nRequired: False\nPosition: 11\nDefault value: Normal\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-exitonprocessfailure",children:"-ExitOnProcessFailure"}),"\n",(0,a.jsx)(n.p,{children:"Specifies whether the function should call Exit-Script when the process returns an exit code that is considered an error/failure.\nDefault: $true"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: Boolean\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 12\nDefault value: True\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-repairfromsource",children:"-RepairFromSource"}),"\n",(0,a.jsx)(n.p,{children:"Specifies whether we should repair from source.\nAlso rewrites local cache.\nDefault: $false"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: Boolean\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 13\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"-continueonerror",children:"-ContinueOnError"}),"\n",(0,a.jsx)(n.p,{children:"Continue if an error occurred while trying to start the process.\nDefault: $false."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Type: Boolean\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 14\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n"})}),"\n",(0,a.jsx)(n.h3,{id:"commonparameters",children:"CommonParameters"}),"\n",(0,a.jsxs)(n.p,{children:["This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see ",(0,a.jsx)(n.a,{href:"http://go.microsoft.com/fwlink/?LinkID=113216",children:"about_CommonParameters"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"inputs",children:"INPUTS"}),"\n",(0,a.jsx)(n.h3,{id:"none",children:"None"}),"\n",(0,a.jsx)(n.h3,{id:"you-cannot-pipe-objects-to-this-function",children:"You cannot pipe objects to this function."}),"\n",(0,a.jsx)(n.h2,{id:"outputs",children:"OUTPUTS"}),"\n",(0,a.jsx)(n.h3,{id:"psobject",children:"PSObject"}),"\n",(0,a.jsx)(n.h3,{id:"returns-a-psobject-with-the-results-of-the-installation",children:"Returns a PSObject with the results of the installation"}),"\n",(0,a.jsx)(n.h3,{id:"--exitcode",children:"- ExitCode"}),"\n",(0,a.jsx)(n.h3,{id:"--stdout",children:"- STDOut"}),"\n",(0,a.jsx)(n.h3,{id:"--stderr",children:"- STDErr"}),"\n",(0,a.jsx)(n.h2,{id:"notes",children:"NOTES"}),"\n",(0,a.jsx)(n.h2,{id:"related-links",children:"RELATED LINKS"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://psappdeploytoolkit.com",children:"https://psappdeploytoolkit.com"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},3309:(e,n,l)=>{l.d(n,{R:()=>s,x:()=>r});var a=l(9474);const i={},t=a.createContext(i);function s(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);